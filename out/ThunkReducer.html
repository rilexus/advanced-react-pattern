<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/advanced-react-pattern/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/advanced-react-pattern/_next/static/chunks/webpack-7383afc4b8866afd.js" defer=""></script><script src="/advanced-react-pattern/_next/static/chunks/framework-d51ece3d757c7ed2.js" defer=""></script><script src="/advanced-react-pattern/_next/static/chunks/main-e5ef016c3425ef5b.js" defer=""></script><script src="/advanced-react-pattern/_next/static/chunks/pages/_app-851a1d6d47233978.js" defer=""></script><script src="/advanced-react-pattern/_next/static/chunks/6083-9882fc2187e8ed4b.js" defer=""></script><script src="/advanced-react-pattern/_next/static/chunks/pages/ThunkReducer-f32af8c15e3a7694.js" defer=""></script><script src="/advanced-react-pattern/_next/static/dkaPSLFTFV1RuUOI8AqT9/_buildManifest.js" defer=""></script><script src="/advanced-react-pattern/_next/static/dkaPSLFTFV1RuUOI8AqT9/_ssgManifest.js" defer=""></script><script src="/advanced-react-pattern/_next/static/dkaPSLFTFV1RuUOI8AqT9/_middlewareManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;}/*!sc*/
body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;margin:0;padding:0;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}/*!sc*/
data-styled.g1[id="sc-global-jbFqTx1"]{content:"sc-global-jbFqTx1,"}/*!sc*/
.fHFsLe{white-space:nowrap;line-height:1.5;}/*!sc*/
data-styled.g5[id="Li__Styled-sc-2pbekf-0"]{content:"fHFsLe,"}/*!sc*/
.jfHJAM{margin-right:auto;margin-left:auto;padding-right:15px;padding-left:15px;width:100%;}/*!sc*/
@media screen and (max-width:575px){.jfHJAM{min-width:97vw;}}/*!sc*/
@media screen and (min-width:576px){.jfHJAM{max-width:1024px;}}/*!sc*/
data-styled.g6[id="Container__Styled-sc-zkefve-0"]{content:"jfHJAM,"}/*!sc*/
</style></head><body><div id="__next"><div class="Container__Styled-sc-zkefve-0 jfHJAM"><div style="display:flex;flex-direction:row"><div style="margin-right:1rem"><nav><ul style="padding-left:1rem"><li class="Li__Styled-sc-2pbekf-0 fHFsLe"><a href="/advanced-react-pattern">Home</a></li><li class="Li__Styled-sc-2pbekf-0 fHFsLe"><h4>Utils</h4><ul style="padding-left:1rem"><li class="Li__Styled-sc-2pbekf-0 fHFsLe"><a href="/advanced-react-pattern/Prefetch">Prefetched State</a></li><li class="Li__Styled-sc-2pbekf-0 fHFsLe"><a href="/advanced-react-pattern/StateSubscription">State Subscription</a></li></ul></li><li class="Li__Styled-sc-2pbekf-0 fHFsLe"><h4>Components</h4><ul style="padding-left:1rem"><li class="Li__Styled-sc-2pbekf-0 fHFsLe"><a href="/advanced-react-pattern/suspense">Suspense</a></li><li class="Li__Styled-sc-2pbekf-0 fHFsLe"><a href="/advanced-react-pattern/CompoundToggle">Compound Components</a></li><li class="Li__Styled-sc-2pbekf-0 fHFsLe"><a href="/advanced-react-pattern/StateReducer">State Reducer</a></li><li class="Li__Styled-sc-2pbekf-0 fHFsLe"><a href="/advanced-react-pattern/PropCollection">Props Collection</a></li><li class="Li__Styled-sc-2pbekf-0 fHFsLe"><a href="/advanced-react-pattern/RenderPropsToggle">Render Props</a></li><li class="Li__Styled-sc-2pbekf-0 fHFsLe"><a href="/advanced-react-pattern/Factory">Factory</a></li><li class="Li__Styled-sc-2pbekf-0 fHFsLe"><a href="/advanced-react-pattern/ControlProps">Control Props</a></li><li class="Li__Styled-sc-2pbekf-0 fHFsLe"><a href="/advanced-react-pattern/Decorator">Decorator</a></li></ul></li><li class="Li__Styled-sc-2pbekf-0 fHFsLe"><h4>Hooks</h4><ul style="padding-left:1rem"><li class="Li__Styled-sc-2pbekf-0 fHFsLe"><a href="/advanced-react-pattern/ThunkReducer">Thunk Reducer</a></li><li class="Li__Styled-sc-2pbekf-0 fHFsLe"><a href="/advanced-react-pattern/ReducerHook">Reducer Hook</a></li></ul></li></ul></nav></div><div><div><main><article><h1>Thunk Reducer</h1><p style="line-height:1.4;font-size:1.125rem;color:#1a1a1a">First I would like to point your attention to this code:</p><div style="margin:1rem 0;font-size:.9rem"><span style="font-size:inherit;font-family:inherit;background:#f3f3f3;color:#25282a;border-radius:3px;display:flex;line-height:1.4285714285714286;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px">const reducer = (state, action) =&gt; state /* add logic here */;
const Component = () =&gt; {
  const [state, dispatch] = useReducer(reducer, {
    data: null,
    error: null,
    status: false /* indicate if data is being fetched */,
  });

  const handleClick = () =&gt; {
    dispatch({
      type: &quot;start-fetching&quot; /* show loading spinner or something */,
    });
    fetchData()
      .then((data) =&gt; {
        dispatch({ type: &quot;data-fetched&quot;, data });
      })
      .catch((error) =&gt; {
        dispatch({ type: &quot;fetching-error&quot;, error });
      });
  };

  return (
    &lt;div&gt;
      &lt;div&gt;{JSON.stringify(state)}&lt;/div&gt;
      &lt;button onClick={handleClick}&gt;Call API&lt;/button&gt;
    &lt;/div&gt;
  );
};</code></span></div><p style="line-height:1.4;font-size:1.125rem;color:#1a1a1a">The order of execution is as follows:</p><ol><li>user clicks on the button</li><li>handleClick is called</li><li>dispatch is called</li><li>fetchData is called</li><li></li></ol><hr/><div><div>&quot;&quot;</div><button>Call API</button><button>Fetch User</button></div><div style="margin:1rem 0;font-size:.9rem"><span style="font-size:inherit;font-family:inherit;background:#f3f3f3;color:#25282a;border-radius:3px;display:flex;line-height:1.4285714285714286;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px">function callAPI(dispatch) {
  dispatch({ type: &quot;call api&quot;, payload: { data: &quot;Calling API...&quot; } });
  setTimeout(() =&gt; {
    const data = &quot;Got data after 2sec.&quot;;
    dispatch({ type: &quot;call api&quot;, payload: { data } });
  }, 2000);
}

function fetchUser(id) {
  return (dispatch) =&gt; {
    dispatch({ type: &quot;user-fetched&quot;, payload: { data: &quot;&quot; } });
  };
}

const Thunk = () =&gt; {
  const [state, dispatch] = useThunkReducer(reducer, { data: &quot;&quot; });

  return (
    &lt;div&gt;
      &lt;div&gt;{JSON.stringify(state.data)}&lt;/div&gt;
      &lt;button onClick={() =&gt; dispatch(callAPI /*pass function as action*/)}&gt;
        Call API
      &lt;/button&gt;
      &lt;button onClick={() =&gt; dispatch(fetchUser(1234))}&gt;Fetch User&lt;/button&gt;
    &lt;/div&gt;
  );
};</code></span></div><div style="margin:1rem 0;font-size:.9rem"><span style="font-size:inherit;font-family:inherit;background:#f3f3f3;color:#25282a;border-radius:3px;display:flex;line-height:1.4285714285714286;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px">function useThunkReducer(reducer, initialState) {
  const [state, dispatch] = useReducer(reducer, initialState);

  const thunkDispatch = (action) =&gt; {
    if (typeof action === &quot;function&quot;) {
      action(dispatch);
    } else {
      dispatch(action);
    }
  };

  return [state, thunkDispatch];
}</code></span></div></article></main></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/ThunkReducer","query":{},"buildId":"dkaPSLFTFV1RuUOI8AqT9","assetPrefix":"/advanced-react-pattern","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>