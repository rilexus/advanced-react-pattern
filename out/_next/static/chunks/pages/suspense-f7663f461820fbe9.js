(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5563],{4359:function(e,n,t){"use strict";t.d(n,{Z:function(){return h}});var r=t(9499),o=(t(7294),t(5893));function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var s=function(e){return(0,o.jsx)("ul",c({style:c({paddingLeft:"1rem"},e.style)},e))},a=t(1664),l=t.n(a),u=t(2125).ZP.li.withConfig({displayName:"Li__Styled",componentId:"sc-2pbekf-0"})(["white-space:nowrap;line-height:1.5;"]),d=function(e){var n=e.children;return(0,o.jsx)(u,{children:n})},h=function(){return(0,o.jsx)("nav",{children:(0,o.jsxs)(s,{children:[(0,o.jsx)(d,{children:(0,o.jsx)(l(),{href:"/",children:"Home"})}),(0,o.jsxs)(d,{children:[(0,o.jsx)("h4",{children:"Utils"}),(0,o.jsxs)(s,{children:[(0,o.jsx)(d,{children:(0,o.jsx)(l(),{href:"/Prefetch",children:(0,o.jsx)("a",{children:"Prefetched State"})})}),(0,o.jsx)(d,{children:(0,o.jsx)(l(),{href:"/StateSubscription",children:"State Subscription"})})]})]}),(0,o.jsxs)(d,{children:[(0,o.jsx)("h4",{children:"Components"}),(0,o.jsxs)(s,{children:[(0,o.jsx)(d,{children:(0,o.jsx)(l(),{href:"/suspense",children:"Suspense"})}),(0,o.jsx)(d,{children:(0,o.jsx)(l(),{href:"/CompoundToggle",children:"Compound Components"})}),(0,o.jsx)(d,{children:(0,o.jsx)(l(),{href:"/StateReducer",children:"State Reducer"})}),(0,o.jsx)(d,{children:(0,o.jsx)(l(),{href:"/PropCollection",children:"Props Collection"})}),(0,o.jsx)(d,{children:(0,o.jsx)(l(),{href:"/RenderPropsToggle",children:"Render Props"})}),(0,o.jsx)(d,{children:(0,o.jsx)(l(),{href:"/Factory",children:"Factory"})}),(0,o.jsx)(d,{children:(0,o.jsx)(l(),{href:"/ControlProps",children:"Control Props"})}),(0,o.jsx)(d,{children:(0,o.jsx)(l(),{href:"/Decorator",children:"Decorator"})})]})]}),(0,o.jsxs)(d,{children:[(0,o.jsx)("h4",{children:"Hooks"}),(0,o.jsxs)(s,{children:[(0,o.jsx)(d,{children:(0,o.jsx)(l(),{href:"/ThunkReducer",children:"Thunk Reducer"})}),(0,o.jsx)(d,{children:(0,o.jsx)(l(),{href:"/ReducerHook",children:"Reducer Hook"})})]})]})]})})}},470:function(e,n,t){"use strict";var r=t(7294);n.Z=function(e,n){return(0,r.useMemo)((function(){return e}),n)}},1185:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Z}});var r=t(2640),o=t(2777),i=t(2262),c=t(5959),s=t(2179),a=t(7247),l=t(9499),u=t(29),d=t(7794),h=t.n(d),p=t(7294),f=t(5),m=t(6820),g=t(5893),j=function(e){var n=e.navigation,t=e.content;return(0,g.jsx)(f.Z,{children:(0,g.jsxs)(m.Z,{children:[(0,g.jsx)("div",{style:{marginRight:"1rem"},children:n}),(0,g.jsx)("div",{children:t})]})})},b=t(4359),y=t(8556),w=function(e){return!e},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,p.useReducer)(e,n)},x=t(4663),k=t(3236);function C(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=(0,a.Z)(e);if(n){var o=(0,a.Z)(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return(0,s.Z)(this,t)}}function O(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}var P=function(){var e=(0,u.Z)(h().mark((function e(){var n,t=arguments;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.length>0&&void 0!==t[0]?t[0]:200,e.abrupt("return",new Promise((function(e){return setTimeout(e,n)})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(e){(0,c.Z)(t,e);var n=C(t);function t(e){var r;return(0,o.Z)(this,t),(r=n.call(this,e)).state={isLoading:!1},r}return(0,i.Z)(t,[{key:"componentDidCatch",value:function(e,n){var t=this;if("function"===typeof e.then){var r=e;this.setState({isLoading:!0}),r.then((function(){t.setState({isLoading:!1})})).catch((function(e){}))}}},{key:"render",value:function(){return this.state.isLoading?this.props.fallback:this.props.children}}]),t}(p.Component),R=function(e){var n=function(){return null},t="pending";return function(r){return(0,p.useEffect)((function(){var r=e().then((function(e){t="resolved",n=e.default})).catch((function(e){t="error"}));if("pending"===t)throw r}),[]),(0,g.jsx)(n,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?O(Object(t),!0).forEach((function(n){(0,l.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):O(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},r))}}(function(){var e=(0,u.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(2e3);case 2:return e.abrupt("return",t.e(9145).then(t.bind(t,6066)));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),Z=function(){var e=v(),n=(0,r.Z)(e,2),t=n[0],o=n[1];return(0,g.jsx)(j,{navigation:(0,g.jsx)(b.Z,{}),content:(0,g.jsx)("main",{children:(0,g.jsxs)("article",{children:[(0,g.jsx)(y.Z,{children:"Suspense"}),(0,g.jsx)(x.P,{children:"Imagine you have a big Single Page Application with a sidebar like this one."}),(0,g.jsx)("img",{width:"500px",height:"auto",src:"/application_sidebar.png"}),(0,g.jsx)(x.P,{children:'Every button lead to a different page. I think the word "view" would be more appropriate, since its not a page. So every view is separate and independent from each other. It has its own purpose, its own code.'}),(0,g.jsx)(x.P,{children:'The user is interested in one view at a time and probably he is not interested in all the views of the application. Just think how often you visit the "setting" view of any application. I bet, you go there one time a month, if at all.'}),(0,g.jsx)(x.P,{children:"Now the thing is, if we as a developer do not pay attention, we would bundle the whole application to one single file. We will have one HTML file with a single div in it, where the application is going to be mounted."}),(0,g.jsx)(x.P,{children:"This has an effect on the user experience. Just think about it! How much code does the application in total has? How many css lines, images, svg`s etc. We ship a lot of code and in our current case, we shit a lot of code at once."}),(0,g.jsxs)(x.P,{children:["Luckily we can improve this by utilising"," ",(0,g.jsx)("a",{href:"https://webpack.js.org/guides/lazy-loading/",children:"webpack and the import function."})]}),(0,g.jsx)(k.E,{children:'const Backlog = await import(/* webpackChunkName: "Backlog" */ "../Backlog");\nconst Board = await  import(/* webpackChunkName: "Board" */"../Board");\nconst Reports = await import(/* webpackChunkName: "Report" */"../Reports");\nconst Releases = await import(/* webpackChunkName: "Releases" */"../Releases");'}),(0,g.jsx)(x.P,{children:"By doing this, webpack will split our application during the build time in small chunks. We will not get one single, heavy file, but multiple small once. One file for every component."}),(0,g.jsx)(x.P,{children:"There is one thing left to do for us. That is to load this js files and to display those components only when we need them."}),(0,g.jsx)(x.P,{children:"One obvious implementation for this could be this one."}),(0,g.jsx)(k.E,{children:'const Component = () => {\n  const [, rerender] = useToggle();\n\n  const backlogRef = useRef(null);\n\n  const loadSidebar = async () => {\n    //if backlog already loaded, do nothing\n    if (backlogRef.current) return;\n\n    const { default: Component } = await import(/* webpackChunkName: "Backlog" */ "../Backlog");\n    backlogRef.current = Component;\n\n    rerender();\n  };\n\n  const Backlog = backlogRef.current;\n  return (\n    <div>\n      <div>\n        {/*sidebar*/}\n        <button onClick={loadSidebar}>Backlog</button>\n      </div>\n      <div>\n        {/*view*/}\n        {Backlog && <Backlog />}\n      </div>\n    </div>\n  );\n};'}),(0,g.jsx)(x.P,{children:"We import the component on click, await the data, save it in a ref, rerender and were done."}),(0,g.jsx)(x.P,{children:'That works great! Although it is manuel work and very verbose. For every view, we would need to write the same logic again and again. I personally would prefer not to think about the implementation at all. I would like to simply use it. I would like to have it more like: "Here is a component. Please load and display it only as soon as I need it."'}),(0,g.jsx)(k.E,{children:"const Backlog = (props) => {\n  const [, rerender] = useToggle();\n  const ref = useRef(() => null);\n  \n  useEffect(() => {\n    import('../Backlog').then(({default: Component}) => {\n      ref.current = Component;\n      \n      rerender()\n    });\n  }, []);\n  \n  const Component = ref.current;\n  return <Component {...props}/>\n}"}),(0,g.jsx)(x.P,{children:"This is much better! Every component is isolated. I can simply import it and use it. I personally would not prefer to write this for every component tho."}),(0,g.jsx)(x.P,{children:"Lets move out the import state."}),(0,g.jsx)(k.E,{children:"const Lazy = ({ factory,...props }) => {\n  const [, rerender] = useToggle();\n  const ref = useRef(null);\n\n  useEffect(() => {\n    factory().then(({ default: Component }) => {\n      ref.current = Component;\n\n      rerender();\n    });\n  }, []);\n\n  const Component = ref.current;\n  return Component && <Component {...props} />;\n};\n\n\nconst Backlog = (props) => {\n  return <Lazy factory={() => import('../Backlog')} {...props}/>\n}"}),(0,g.jsx)(x.P,{children:"Instead of hard code the import, we delegate the import call to a function. Now I do not need to reimplement the same logic multiple times. This solution is definitely better then the thing we have started with. Still to much work to. I do not like to worry about the props spreading, passing the import statement in to a component, wrap it in another component. Hustle! All this should be automated even further."}),(0,g.jsx)(x.P,{children:"Something like this would be awesome!"}),(0,g.jsx)(k.E,{children:'const BackLog = lazy(() => import("../Backlog"));'}),(0,g.jsx)(x.P,{children:"I get a component back, the import is delegated and I should not worry about props."}),(0,g.jsx)(k.E,{children:"const lazy = (factory) => {\n  // return a React component function\n  return function LazyWrapper(props) {\n    const [, rerender] = useToggle();\n    const ref = useRef(() => null);\n    useEffect(() => {\n      // load JS module right away, LazyWrapper lazy is called\n      factory()\n        // wait for the JS module to be resolved\n        .then(({ default: Component }) => {\n          ref.current = Component;\n\n          rerender();\n        })\n        .catch((e) => {\n          // handle error\n        });\n    }, []);\n\n    const Component = ref.current;\n    return <Component {...props} />;\n  };\n};"}),(0,g.jsx)(x.P,{children:"By importing "}),(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{children:(0,g.jsx)("button",{onClick:o,children:"Load"})}),(0,g.jsx)("div",{children:(0,g.jsx)(S,{fallback:(0,g.jsx)("div",{children:"Loading..."}),children:t&&(0,g.jsx)(R,{})})})]})]})})})}},3676:function(e,n,t){"use strict";t(7294);var r=t(939),o=t(5893),i={lineNumberColor:"#333333",lineNumberBgColor:"white",backgroundColor:"#f3f3f3",textColor:"#25282a",substringColor:"#6A8759",keywordColor:"#c95464",attributeColor:"#c95464",selectorAttributeColor:"#a71d5d",docTagColor:"#333333",nameColor:"#63a35c",builtInColor:"#333333",literalColor:"#0086b3",bulletColor:"#0086b3",codeColor:"#333333",additionColor:"#55a532",regexpColor:"#333333",symbolColor:"#0086b3",variableColor:"#df5000",templateVariableColor:"#df5000",linkColor:"#0366d6",selectorClassColor:"#795da3",typeColor:"#a71d5d",stringColor:"#6eb240",selectorIdColor:"#795da3",quoteColor:"#df5000",templateTagColor:"#a88609",deletionColor:"#bd2c00",titleColor:"#795da3",sectionColor:"#a88609",commentColor:"#969896",metaKeywordColor:"#333333",metaColor:"#969896",functionColor:"#675c98",numberColor:"#6897BB"};n.Z=function(e){var n=e.children;return(0,o.jsx)("div",{style:{margin:"1rem 0",fontSize:".9rem"},children:(0,o.jsx)(r.dn,{text:n,language:"jsx",showLineNumbers:!1,theme:i})})}},3236:function(e,n,t){"use strict";t.d(n,{E:function(){return r.Z}});var r=t(3676)},5:function(e,n,t){"use strict";t(7294);var r=t(2125),o=t(5893),i=r.ZP.div.withConfig({displayName:"Container__Styled",componentId:"sc-zkefve-0"})(["margin-right:auto;margin-left:auto;padding-right:15px;padding-left:15px;width:100%;@media screen and (max-width:575px){min-width:97vw;}@media screen and (min-width:576px){max-width:1024px;}"]);n.Z=function(e){var n=e.children;return(0,o.jsx)(i,{children:n})}},6820:function(e,n,t){"use strict";t(7294);var r=t(5893);n.Z=function(e){var n=e.children,t=e.direction,o=void 0===t?"row":t;return(0,r.jsx)("div",{style:{display:"flex",flexDirection:o},children:n})}},8556:function(e,n,t){"use strict";var r=t(9499),o=(t(7294),t(470)),i=t(5893);function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}n.Z=function(e){var n=(0,o.Z)(s({fontSize:"2rem"},e.style),[e.style]);return(0,i.jsx)("h1",s(s({},e),{},{style:n}))}},4663:function(e,n,t){"use strict";t.d(n,{P:function(){return a}});var r=t(9499),o=(t(7294),t(470)),i=t(5893);function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var a=function(e){var n=(0,o.Z)(s(s({},e.style),{},{lineHeight:"1.4",fontSize:"1.125rem",color:"#1a1a1a"}),[]);return(0,i.jsx)("p",s(s({},e),{},{style:n}))}},2236:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/suspense",function(){return t(1185)}])}},function(e){e.O(0,[939,8782,9774,2888,179],(function(){return n=2236,e(e.s=n);var n}));var n=e.O();_N_E=n}]);