<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/advanced-react-pattern/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/advanced-react-pattern/_next/static/chunks/webpack-79bfb6a7cdfac8de.js" defer=""></script><script src="/advanced-react-pattern/_next/static/chunks/framework-0ba0ddd33199226d.js" defer=""></script><script src="/advanced-react-pattern/_next/static/chunks/main-c82185d11959f538.js" defer=""></script><script src="/advanced-react-pattern/_next/static/chunks/pages/_app-ed76948c8b6fd9ce.js" defer=""></script><script src="/advanced-react-pattern/_next/static/chunks/pages/ReducerHook-79efa2820217264e.js" defer=""></script><script src="/advanced-react-pattern/_next/static/fvwCxEquKZDtDEUMnRYS2/_buildManifest.js" defer=""></script><script src="/advanced-react-pattern/_next/static/fvwCxEquKZDtDEUMnRYS2/_ssgManifest.js" defer=""></script><script src="/advanced-react-pattern/_next/static/fvwCxEquKZDtDEUMnRYS2/_middlewareManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.QgnfO figure{margin:0;}/*!sc*/
.QgnfO .hljs{background:#f6f6f6;color:black;border-radius:0.5rem;padding:2rem 1rem 2rem 2rem;font-size:0.95rem;line-height:1.25;}/*!sc*/
.QgnfO .xml .hljs-meta{color:#c0c0c0;}/*!sc*/
.QgnfO .hljs-comment,.QgnfO .hljs-quote{color:#007400;}/*!sc*/
.QgnfO .hljs-tag,.QgnfO .hljs-attribute,.QgnfO .hljs-keyword,.QgnfO .hljs-selector-tag,.QgnfO .hljs-literal,.QgnfO .hljs-name{color:#aa0d91;}/*!sc*/
.QgnfO .hljs-variable,.QgnfO .hljs-template-variable{color:#3f6e74;}/*!sc*/
.QgnfO .hljs-code,.QgnfO .hljs-string,.QgnfO .hljs-meta .hljs-string{color:#c41a16;}/*!sc*/
.QgnfO .hljs-regexp,.QgnfO .hljs-link{color:#0e0eff;}/*!sc*/
.QgnfO .hljs-title,.QgnfO .hljs-symbol,.QgnfO .hljs-bullet,.QgnfO .hljs-number{color:#1c00cf;}/*!sc*/
.QgnfO .hljs-section,.QgnfO .hljs-meta{color:#643820;}/*!sc*/
.QgnfO .hljs-title.class_,.QgnfO .hljs-class .hljs-title,.QgnfO .hljs-type,.QgnfO .hljs-built_in,.QgnfO .hljs-params{color:#5c2699;}/*!sc*/
.QgnfO .hljs-attr{color:#836c28;}/*!sc*/
.QgnfO .hljs-subst{color:#000;}/*!sc*/
.QgnfO .hljs-formula{background-color:#eee;font-style:italic;}/*!sc*/
.QgnfO .hljs-addition{background-color:#baeeba;}/*!sc*/
.QgnfO .hljs-deletion{background-color:#ffc8bd;}/*!sc*/
.QgnfO .hljs-selector-id,.QgnfO .hljs-selector-class{color:#9b703f;}/*!sc*/
.QgnfO .hljs-doctag,.QgnfO .hljs-strong{font-weight:bold;}/*!sc*/
.QgnfO .hljs-emphasis{font-style:italic;}/*!sc*/
data-styled.g1[id="Code__CodeTheme-sc-1i7zmjv-0"]{content:"QgnfO,"}/*!sc*/
.fwqmoU{margin-top:44px;margin-bottom:44px;overflow-x:scroll;}/*!sc*/
data-styled.g2[id="Code__StyledPre-sc-1i7zmjv-1"]{content:"fwqmoU,"}/*!sc*/
html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;}/*!sc*/
body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;margin:0;padding:0;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}/*!sc*/
data-styled.g3[id="sc-global-jbFqTx1"]{content:"sc-global-jbFqTx1,"}/*!sc*/
.QPxGF{margin-right:auto;margin-left:auto;padding-right:15px;padding-left:15px;width:100%;max-width:992px;}/*!sc*/
@media (min-width:576px){.QPxGF{width:99vw;}}/*!sc*/
@media (min-width:768px){.QPxGF{width:90vw;}}/*!sc*/
@media (min-width:992px){.QPxGF{width:70vw;}}/*!sc*/
@media (min-width:1200px){.QPxGF{width:40vw;}}/*!sc*/
data-styled.g4[id="Container__Styled-sc-zkefve-0"]{content:"QPxGF,"}/*!sc*/
.gpnAYg{height:100vh;background:rgba(255,255,255,0.76);top:0;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);left:0;padding-left:2rem;-webkit-transition:-webkit-transform 200ms;-webkit-transition:transform 200ms;transition:transform 200ms;width:300px;position:fixed;}/*!sc*/
data-styled.g5[id="Layout__StyledSidebar-sc-1tqca63-0"]{content:"gpnAYg,"}/*!sc*/
.fnJOng{white-space:nowrap;line-height:1.5;padding-bottom:0.4rem;}/*!sc*/
data-styled.g6[id="Li__Styled-sc-2pbekf-0"]{content:"fnJOng,"}/*!sc*/
.hWeMkM{cursor:pointer;font-size:1.1rem;-webkit-text-decoration:none;text-decoration:none;color:blue;position:relative;}/*!sc*/
.hWeMkM:hover:after{-webkit-transform:translateX(1rem) translateY(-50%) rotate(-45deg);-ms-transform:translateX(1rem) translateY(-50%) rotate(-45deg);transform:translateX(1rem) translateY(-50%) rotate(-45deg);opacity:1;}/*!sc*/
.hWeMkM:after{content:" ";width:0.5rem;height:0.5rem;opacity:0;position:absolute;-webkit-transform:translateY(-50%) rotate(-45deg);-ms-transform:translateY(-50%) rotate(-45deg);transform:translateY(-50%) rotate(-45deg);-webkit-transform-origin:50% 50%;-ms-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transition:-webkit-transform 200ms,opacity 200ms;-webkit-transition:transform 200ms,opacity 200ms;transition:transform 200ms,opacity 200ms;right:0;top:50%;border-right:2px solid blue;border-bottom:2px solid blue;}/*!sc*/
data-styled.g7[id="Link__StyledLink-sc-wozd19-0"]{content:"hWeMkM,"}/*!sc*/
.fEHXxv{margin-bottom:1.4211em;font-size:1.125rem;color:#1a1a1a;line-height:1.4211;font-weight:400;-webkit-letter-spacing:0.012em;-moz-letter-spacing:0.012em;-ms-letter-spacing:0.012em;letter-spacing:0.012em;font-family:"SF Pro Display","SF Pro Icons","Helvetica Neue","Helvetica","Arial",sans-serif;}/*!sc*/
data-styled.g8[id="P__StyledP-sc-f4vqmk-0"]{content:"fEHXxv,"}/*!sc*/
</style></head><body><div id="__next"><div><div class="Container__Styled-sc-zkefve-0 QPxGF"><div><div><main><article><h1>Reducer Hook</h1><p class="P__StyledP-sc-f4vqmk-0 fEHXxv"><i>After this article you will understand how the useReducer hook works and why we need it.</i></p><p class="P__StyledP-sc-f4vqmk-0 fEHXxv">The useReducer hook helps you with handling a big state object which data needs to be processed with complex logic. And it creates pretty, uniform interface to other components.</p><p class="P__StyledP-sc-f4vqmk-0 fEHXxv">Lets look at an example.</p><div style="position:relative" class="Code__CodeTheme-sc-1i7zmjv-0 QgnfO"><div itemscope="" itemType="https://schema.org/SoftwareSourceCode"><div itemProp="audience" itemscope="" itemtype="https://schema.org/Audience"><meta itemProp="audienceType" content="programmers"/></div><meta itemProp="codeSampleType" content="code snippet"/><meta itemProp="codeRepository" content="https://github.com/rilexus/advanced-react-pattern"/><div itemProp="maintainer" itemscope="" itemType="https://schema.org/Person"><meta itemProp="image" content="https://avatars.githubusercontent.com/u/28537457?v=4"/><meta itemProp="sameAs" content="https://github.com/rilexus"/><meta itemProp="name" content="Stanislav Panchenko"/></div><div itemProp="author" itemscope="" itemType="https://schema.org/Person"><meta itemProp="image" content="https://avatars.githubusercontent.com/u/28537457?v=4"/><meta itemProp="sameAs" content="https://github.com/rilexus"/><meta itemProp="name" content="Stanislav Panchenko"/></div><meta itemProp="programmingLanguage" content="javascript"/><pre class="Code__StyledPre-sc-1i7zmjv-1 fwqmoU">const Component = () =&gt; {
  const [name, setName] = useState(&quot;&quot;);
  const [surname, setSurname] = useState(&quot;&quot;);
  const [tel, setTel] = useState(&quot;&quot;);
  const [street, setStreet] = useState(&quot;&quot;);
  const [city, setCity] = useState(&quot;&quot;);
  // ... add other user and address states

  const handleSubmit = (e) =&gt; {
    e.preventDefault();
    fetch(&quot;/api/user&quot;, {
      method: &quot;post&quot;,
      body: JSON.stringify({
        name,
        surname,
        tel,
        city,
        street,
        /* add other values */
      }),
    });
  };

  return (
    &lt;div&gt;
      &lt;form onSubmit={handleSubmit}&gt;
        &lt;input
          type=&quot;text&quot;
          value={name}
          onChange={(e) =&gt; {
            setName(e.target.value);
          }}
        /&gt;
        &lt;input
          type=&quot;text&quot;
          value={surname}
          onChange={(e) =&gt; {
            setSurname(e.target.value);
          }}
        /&gt;
        &lt;input
          type=&quot;tel&quot;
          value={tel}
          onChange={(e) =&gt; {
            setTel(e.target.value);
          }}
        /&gt;
        &lt;input
          type=&quot;text&quot;
          value={street}
          onChange={(e) =&gt; {
            setStreet(e.target.value);
          }}
        /&gt;
        &lt;input
          type=&quot;text&quot;
          value={city}
          onChange={(e) =&gt; {
            setCity(e.target.value);
          }}
        /&gt;
        &lt;button type={&quot;submit&quot;}&gt;Submit&lt;/button&gt;
      &lt;/form&gt;
    &lt;/div&gt;
  );
};</pre></div></div><p class="P__StyledP-sc-f4vqmk-0 fEHXxv">As you can see this is a form. A form is usually not complicated but they are almost every time pretty complex from the programmer perspective. Take a moment and remember the times you needed to write validation logic for a form.</p><img src="https://media.giphy.com/media/Wh3ugh7bXTxUk/giphy.gif" alt=""/><p class="P__StyledP-sc-f4vqmk-0 fEHXxv">For this example ill stick with 5 inputs but in the reality, you would have many more. Imagine options input, select inputs, file upload etc. Lets rewrite this component in such a way that its manageable and extendable.</p><div style="position:relative" class="Code__CodeTheme-sc-1i7zmjv-0 QgnfO"><div itemscope="" itemType="https://schema.org/SoftwareSourceCode"><div itemProp="audience" itemscope="" itemtype="https://schema.org/Audience"><meta itemProp="audienceType" content="programmers"/></div><meta itemProp="codeSampleType" content="code snippet"/><meta itemProp="codeRepository" content="https://github.com/rilexus/advanced-react-pattern"/><div itemProp="maintainer" itemscope="" itemType="https://schema.org/Person"><meta itemProp="image" content="https://avatars.githubusercontent.com/u/28537457?v=4"/><meta itemProp="sameAs" content="https://github.com/rilexus"/><meta itemProp="name" content="Stanislav Panchenko"/></div><div itemProp="author" itemscope="" itemType="https://schema.org/Person"><meta itemProp="image" content="https://avatars.githubusercontent.com/u/28537457?v=4"/><meta itemProp="sameAs" content="https://github.com/rilexus"/><meta itemProp="name" content="Stanislav Panchenko"/></div><meta itemProp="programmingLanguage" content="javascript"/><pre class="Code__StyledPre-sc-1i7zmjv-1 fwqmoU">const Component = () =&gt; {
  const [formValues, setFormValues] = useState({
    city: &quot;&quot;,
    tel: &quot;&quot;,
    street: &quot;&quot;,
    name: &quot;&quot;,
    surname: &quot;&quot;,
  });
  // ... add other user and address states

  const handleSubmit = (e) =&gt; {
    e.preventDefault();
    fetch(&quot;/api/user&quot;, {
      method: &quot;post&quot;,
      body: JSON.stringify(formValues),
    });
  };

  const createOnChangeHandler = (name) =&gt; {
    return (e) =&gt; {
      const value = e.target.value;
      setFormValues((state) =&gt; ({ ...state, [name]: value }));
    };
  };

  return (
    &lt;div&gt;
      &lt;form onSubmit={handleSubmit}&gt;
        &lt;input
          type=&quot;text&quot;
          value={formValues.name}
          onChange={createOnChangeHandler(&quot;name&quot;)}
          {/* nothing changed here */}
        /&gt;
      &lt;/form&gt;
    &lt;/div&gt;
  );
};</pre></div></div><p class="P__StyledP-sc-f4vqmk-0 fEHXxv">That looks better. We have a single state and one single function to update it. But we still lack the validation tho.</p><p class="P__StyledP-sc-f4vqmk-0 fEHXxv">We could come up with something like this.</p><div style="position:relative" class="Code__CodeTheme-sc-1i7zmjv-0 QgnfO"><div itemscope="" itemType="https://schema.org/SoftwareSourceCode"><div itemProp="audience" itemscope="" itemtype="https://schema.org/Audience"><meta itemProp="audienceType" content="programmers"/></div><meta itemProp="codeSampleType" content="code snippet"/><meta itemProp="codeRepository" content="https://github.com/rilexus/advanced-react-pattern"/><div itemProp="maintainer" itemscope="" itemType="https://schema.org/Person"><meta itemProp="image" content="https://avatars.githubusercontent.com/u/28537457?v=4"/><meta itemProp="sameAs" content="https://github.com/rilexus"/><meta itemProp="name" content="Stanislav Panchenko"/></div><div itemProp="author" itemscope="" itemType="https://schema.org/Person"><meta itemProp="image" content="https://avatars.githubusercontent.com/u/28537457?v=4"/><meta itemProp="sameAs" content="https://github.com/rilexus"/><meta itemProp="name" content="Stanislav Panchenko"/></div><meta itemProp="programmingLanguage" content="javascript"/><pre class="Code__StyledPre-sc-1i7zmjv-1 fwqmoU">const Component = () =&gt; {
  const [formValues, setFormValues] = useState({
    city: {
      error: null,
      value: &quot;&quot;,
    },
    tel: {
      error: null,
      value: &quot;&quot;,
    },
    street: {
      error: null,
      value: &quot;&quot;,
    },
    name: {
      error: null,
      value: &quot;&quot;,
    },
    surname: {
      error: null,
      value: &quot;&quot;,
    },
  });

  const handleSubmit = (e) =&gt; {
    e.preventDefault();
    fetch(&quot;/api/user&quot;, {
      method: &quot;post&quot;,
      body: JSON.stringify(formValues),
    });
  };

  const validate = (state, value) =&gt; {
    // TODO:
    //  implement validation based on the current state and the current value,
    //  return error string e.g. &quot;Must of length ...&quot;
    return null;
  };

  const createOnChangeHandler = (name) =&gt; {
    return (e) =&gt; {
      const value = e.target.value;

      const error = validate(formValues, value);

      setFormValues((state) =&gt; ({
        ...state,
        [name]: { ...state[name], value, error },
      }));
    };
  };

  return (
    &lt;div&gt;
      &lt;form onSubmit={handleSubmit}&gt;
        &lt;input
          type=&quot;text&quot;
          value={formValues.name.value}
          onChange={createOnChangeHandler(&quot;name&quot;)}
        /&gt;
        {/* nothing changed here */}
      &lt;/form&gt;
    &lt;/div&gt;
  );
};</pre></div></div><p class="P__StyledP-sc-f4vqmk-0 fEHXxv">I provide a validation function and the state is larger now. As you can see, the component grows. And as soon as we start handling onClick and on onBlur events, because we do not like to display error messages as soon as the user makes a mistake, the component will explode in complexity. The state, the validation function and the event handler need to go!</p><div style="position:relative" class="Code__CodeTheme-sc-1i7zmjv-0 QgnfO"><div itemscope="" itemType="https://schema.org/SoftwareSourceCode"><div itemProp="audience" itemscope="" itemtype="https://schema.org/Audience"><meta itemProp="audienceType" content="programmers"/></div><meta itemProp="codeSampleType" content="code snippet"/><meta itemProp="codeRepository" content="https://github.com/rilexus/advanced-react-pattern"/><div itemProp="maintainer" itemscope="" itemType="https://schema.org/Person"><meta itemProp="image" content="https://avatars.githubusercontent.com/u/28537457?v=4"/><meta itemProp="sameAs" content="https://github.com/rilexus"/><meta itemProp="name" content="Stanislav Panchenko"/></div><div itemProp="author" itemscope="" itemType="https://schema.org/Person"><meta itemProp="image" content="https://avatars.githubusercontent.com/u/28537457?v=4"/><meta itemProp="sameAs" content="https://github.com/rilexus"/><meta itemProp="name" content="Stanislav Panchenko"/></div><meta itemProp="programmingLanguage" content="javascript"/><pre class="Code__StyledPre-sc-1i7zmjv-1 fwqmoU">const initialState = {
  city: {
    error: null,
    value: &quot;&quot;,
  },
  tel: {
    error: null,
    value: &quot;&quot;,
  },
  street: {
    error: null,
    value: &quot;&quot;,
  },
  name: {
    error: null,
    value: &quot;&quot;,
  },
  surname: {
    error: null,
    value: &quot;&quot;,
  },
};

const validate = (state, value) =&gt; {
  // TODO:
  //  implement validation based on the current state and the current value,
  //  return error string e.g. &quot;Must of length ...&quot;
  return null;
};

const getNewState = (state, { name, value }) =&gt; {
  const error = validate(state, value);

  return {
    ...state,
    [name]: { ...state[name], value, error },
  };
};

const Component = (reduceState = getNewState, state = initialState) =&gt; {
  const [formValues, setFormValues] = useState(state);

  const handleSubmit = (e) =&gt; {
    e.preventDefault();
    fetch(&quot;/api/user&quot;, {
      method: &quot;post&quot;,
      body: JSON.stringify(formValues),
    });
  };

  const createOnChangeHandler = (name) =&gt; {
    return (e) =&gt; {
      const value = e.target.value;
      const newState = reduceState(formValues, { name, value });
      setFormValues(newState);
    };
  };

  return (
    &lt;div&gt;
      &lt;form onSubmit={handleSubmit}&gt;
        &lt;input
          type=&quot;text&quot;
          value={formValues.name.value}
          onChange={createOnChangeHandler(&quot;name&quot;)}
        /&gt;
        {/* nothing changed here */}
      &lt;/form&gt;
    &lt;/div&gt;
  );
};</pre></div></div><p class="P__StyledP-sc-f4vqmk-0 fEHXxv">I have moved out the initial state outside of the component and provide it as a default prop to the component. The validation and the state merging is outside now as well. Because of this the component and all the logic is pretty easy to unit test as well.</p><img src="https://media.giphy.com/media/hXDrTueJWAscK3xWQ2/giphy.gif" alt=""/><p class="P__StyledP-sc-f4vqmk-0 fEHXxv">We can refactor the useState and the reduceState function to something like this.</p><div style="position:relative" class="Code__CodeTheme-sc-1i7zmjv-0 QgnfO"><div itemscope="" itemType="https://schema.org/SoftwareSourceCode"><div itemProp="audience" itemscope="" itemtype="https://schema.org/Audience"><meta itemProp="audienceType" content="programmers"/></div><meta itemProp="codeSampleType" content="code snippet"/><meta itemProp="codeRepository" content="https://github.com/rilexus/advanced-react-pattern"/><div itemProp="maintainer" itemscope="" itemType="https://schema.org/Person"><meta itemProp="image" content="https://avatars.githubusercontent.com/u/28537457?v=4"/><meta itemProp="sameAs" content="https://github.com/rilexus"/><meta itemProp="name" content="Stanislav Panchenko"/></div><div itemProp="author" itemscope="" itemType="https://schema.org/Person"><meta itemProp="image" content="https://avatars.githubusercontent.com/u/28537457?v=4"/><meta itemProp="sameAs" content="https://github.com/rilexus"/><meta itemProp="name" content="Stanislav Panchenko"/></div><meta itemProp="programmingLanguage" content="javascript"/><pre class="Code__StyledPre-sc-1i7zmjv-1 fwqmoU">const useStateReducer = (getNewState, initialState) =&gt; {
  const [state, setState] = useState(initialState);

  const reduceState = (action) =&gt; {
    const newState = getNewState(state, action);
    setState(newState);
  };

  return [state, reduceState];
};</pre></div></div><p class="P__StyledP-sc-f4vqmk-0 fEHXxv">Now we do not need to set the new state ourself. The custom hook does that for us. The form implementation looks like this now.</p><div style="position:relative" class="Code__CodeTheme-sc-1i7zmjv-0 QgnfO"><div itemscope="" itemType="https://schema.org/SoftwareSourceCode"><div itemProp="audience" itemscope="" itemtype="https://schema.org/Audience"><meta itemProp="audienceType" content="programmers"/></div><meta itemProp="codeSampleType" content="code snippet"/><meta itemProp="codeRepository" content="https://github.com/rilexus/advanced-react-pattern"/><div itemProp="maintainer" itemscope="" itemType="https://schema.org/Person"><meta itemProp="image" content="https://avatars.githubusercontent.com/u/28537457?v=4"/><meta itemProp="sameAs" content="https://github.com/rilexus"/><meta itemProp="name" content="Stanislav Panchenko"/></div><div itemProp="author" itemscope="" itemType="https://schema.org/Person"><meta itemProp="image" content="https://avatars.githubusercontent.com/u/28537457?v=4"/><meta itemProp="sameAs" content="https://github.com/rilexus"/><meta itemProp="name" content="Stanislav Panchenko"/></div><meta itemProp="programmingLanguage" content="javascript"/><pre class="Code__StyledPre-sc-1i7zmjv-1 fwqmoU">const Component = (reducer = getNewState, state = initialState) =&gt; {
  const [formValues, dispatch] = useStateReducer(reducer, state);

  const handleSubmit = (e) =&gt; {
    e.preventDefault();
    fetch(&quot;/api/user&quot;, {
      method: &quot;post&quot;,
      body: JSON.stringify(formValues),
    });
  };

  const createOnChangeHandler = (name) =&gt; {
    return (e) =&gt; {
      const value = e.target.value;
      dispatch({ name, value });
    };
  };

  return (
    &lt;div&gt;
      &lt;form onSubmit={handleSubmit}&gt;
        &lt;input
          type=&quot;text&quot;
          value={formValues.name.value}
          onChange={createOnChangeHandler(&quot;name&quot;)}
        /&gt;
        {/*nothing changed here*/}
      &lt;/form&gt;
    &lt;/div&gt;
  );
};</pre></div></div><p class="P__StyledP-sc-f4vqmk-0 fEHXxv">Now if we would like to handle the onClick and onBlur events as well, we can easily do that by adjusting the getState function and adding a new attribute to the dispatch object.</p><div style="position:relative" class="Code__CodeTheme-sc-1i7zmjv-0 QgnfO"><div itemscope="" itemType="https://schema.org/SoftwareSourceCode"><div itemProp="audience" itemscope="" itemtype="https://schema.org/Audience"><meta itemProp="audienceType" content="programmers"/></div><meta itemProp="codeSampleType" content="code snippet"/><meta itemProp="codeRepository" content="https://github.com/rilexus/advanced-react-pattern"/><div itemProp="maintainer" itemscope="" itemType="https://schema.org/Person"><meta itemProp="image" content="https://avatars.githubusercontent.com/u/28537457?v=4"/><meta itemProp="sameAs" content="https://github.com/rilexus"/><meta itemProp="name" content="Stanislav Panchenko"/></div><div itemProp="author" itemscope="" itemType="https://schema.org/Person"><meta itemProp="image" content="https://avatars.githubusercontent.com/u/28537457?v=4"/><meta itemProp="sameAs" content="https://github.com/rilexus"/><meta itemProp="name" content="Stanislav Panchenko"/></div><meta itemProp="programmingLanguage" content="javascript"/><pre class="Code__StyledPre-sc-1i7zmjv-1 fwqmoU">const getNewState = (state, { type, name, value }) =&gt; {
  if (type === &quot;onChange&quot;) {
    const error = validate(state, value);
    return {
      ...state,
      [name]: { ...state[name], value, error },
    };
  }
  if (type === &quot;onBlur&quot;) {
    // TODO:
    //   handle onBlur event
    return state;
  }
};

const Component = (reducer = getNewState, state = initialState) =&gt; {
  const [formValues, dispatch] = useStateReducer(reducer, state);

  const handleSubmit = (e) =&gt; {
    e.preventDefault();
    fetch(&quot;/api/user&quot;, {
      method: &quot;post&quot;,
      body: JSON.stringify(formValues),
    });
  };

  const createOnChangeHandler = (name) =&gt; {
    return (e) =&gt; {
      const value = e.target.value;
      dispatch({ type: &quot;onChange&quot;, name, value });
    };
  };

  const createOnClickHandler = (name) =&gt; {
    return (e) =&gt; {
      const value = e.target.value;
      dispatch({ type: &quot;onClick&quot;, name, value });
    };
  };

  return (
    &lt;div&gt;
      &lt;form onSubmit={handleSubmit}&gt;
        &lt;input
          type=&quot;text&quot;
          onClick={createOnClickHandler(&quot;name&quot;)}
          value={formValues.name.value}
          onChange={createOnChangeHandler(&quot;name&quot;)}
        /&gt;
        {/*nothing changed here*/}
      &lt;/form&gt;
    &lt;/div&gt;
  );</pre></div></div><p class="P__StyledP-sc-f4vqmk-0 fEHXxv">The only thing left to do is to rename the custom hook and we would get the implementation of the useReducer.</p><div style="position:relative" class="Code__CodeTheme-sc-1i7zmjv-0 QgnfO"><div itemscope="" itemType="https://schema.org/SoftwareSourceCode"><div itemProp="audience" itemscope="" itemtype="https://schema.org/Audience"><meta itemProp="audienceType" content="programmers"/></div><meta itemProp="codeSampleType" content="code snippet"/><meta itemProp="codeRepository" content="https://github.com/rilexus/advanced-react-pattern"/><div itemProp="maintainer" itemscope="" itemType="https://schema.org/Person"><meta itemProp="image" content="https://avatars.githubusercontent.com/u/28537457?v=4"/><meta itemProp="sameAs" content="https://github.com/rilexus"/><meta itemProp="name" content="Stanislav Panchenko"/></div><div itemProp="author" itemscope="" itemType="https://schema.org/Person"><meta itemProp="image" content="https://avatars.githubusercontent.com/u/28537457?v=4"/><meta itemProp="sameAs" content="https://github.com/rilexus"/><meta itemProp="name" content="Stanislav Panchenko"/></div><meta itemProp="programmingLanguage" content="javascript"/><pre class="Code__StyledPre-sc-1i7zmjv-1 fwqmoU">const useReducer = (reducer, initialState) =&gt; {
  const [state, setState] = useState(initialState);

  const dispatch = (action) =&gt; {
    const newState = reducer(state, action);
    setState(newState);
  };

  return [state, dispatch];
};</pre></div></div><p class="P__StyledP-sc-f4vqmk-0 fEHXxv">That is the benefit of the useReducer hook: the component stays small and cute. All the heavy logic is outside of it. And everything is testable.</p><img src="https://media.giphy.com/media/xSM46ernAUN3y/giphy.gif" alt=""/></article></main></div></div><div style="transform:translate(-350px);box-shadow:none" class="Layout__StyledSidebar-sc-1tqca63-0 gpnAYg"><button style="width:3rem;height:3rem;border-radius:3rem;border:1px solid #d8d8d8;display:flex;align-items:center;justify-content:center;cursor:pointer;position:absolute;top:20px;right:-5rem;transition:transform 200ms;transform:rotate(180deg)"><svg stroke="currentColor" fill="currentColor" height="1rem" width="1rem" stroke-width="0" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M217.9 256L345 129c9.4-9.4 9.4-24.6 0-33.9-9.4-9.4-24.6-9.3-34 0L167 239c-9.1 9.1-9.3 23.7-.7 33.1L310.9 417c4.7 4.7 10.9 7 17 7s12.3-2.3 17-7c9.4-9.4 9.4-24.6 0-33.9L217.9 256z"></path></svg></button><nav><ul style="padding-left:1rem"><li class="Li__Styled-sc-2pbekf-0 fnJOng"><a class="Link__StyledLink-sc-wozd19-0 hWeMkM">Home</a></li><li class="Li__Styled-sc-2pbekf-0 fnJOng"><h4>Utils</h4><ul style="padding-left:1rem"><li class="Li__Styled-sc-2pbekf-0 fnJOng"><a class="Link__StyledLink-sc-wozd19-0 hWeMkM">Prefetched State</a></li><li class="Li__Styled-sc-2pbekf-0 fnJOng"><a class="Link__StyledLink-sc-wozd19-0 hWeMkM">State Subscription</a></li></ul></li><li class="Li__Styled-sc-2pbekf-0 fnJOng"><h4>Components</h4><ul style="padding-left:1rem"><li class="Li__Styled-sc-2pbekf-0 fnJOng"><a class="Link__StyledLink-sc-wozd19-0 hWeMkM">Suspense</a></li><li class="Li__Styled-sc-2pbekf-0 fnJOng"><a class="Link__StyledLink-sc-wozd19-0 hWeMkM">Compound Components</a></li><li class="Li__Styled-sc-2pbekf-0 fnJOng"><a class="Link__StyledLink-sc-wozd19-0 hWeMkM">State Reducer</a></li><li class="Li__Styled-sc-2pbekf-0 fnJOng"><a class="Link__StyledLink-sc-wozd19-0 hWeMkM">Props Collection</a></li><li class="Li__Styled-sc-2pbekf-0 fnJOng"><a class="Link__StyledLink-sc-wozd19-0 hWeMkM">Render Props</a></li><li class="Li__Styled-sc-2pbekf-0 fnJOng"><a class="Link__StyledLink-sc-wozd19-0 hWeMkM">Factory</a></li><li class="Li__Styled-sc-2pbekf-0 fnJOng"><a class="Link__StyledLink-sc-wozd19-0 hWeMkM">Control Props</a></li><li class="Li__Styled-sc-2pbekf-0 fnJOng"><a class="Link__StyledLink-sc-wozd19-0 hWeMkM">Decorator</a></li></ul></li><li class="Li__Styled-sc-2pbekf-0 fnJOng"><h4>Hooks</h4><ul style="padding-left:1rem"><li class="Li__Styled-sc-2pbekf-0 fnJOng"><a class="Link__StyledLink-sc-wozd19-0 hWeMkM">Reducer Hook</a></li><li class="Li__Styled-sc-2pbekf-0 fnJOng"><a class="Link__StyledLink-sc-wozd19-0 hWeMkM">Undo State</a></li><li class="Li__Styled-sc-2pbekf-0 fnJOng"><a class="Link__StyledLink-sc-wozd19-0 hWeMkM">Thunk Reducer</a></li><li class="Li__Styled-sc-2pbekf-0 fnJOng"><a class="Link__StyledLink-sc-wozd19-0 hWeMkM">Fetch Hook</a></li></ul></li></ul></nav></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/ReducerHook","query":{},"buildId":"fvwCxEquKZDtDEUMnRYS2","assetPrefix":"/advanced-react-pattern","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>